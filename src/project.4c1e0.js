window.__require=function e(t,n,o){function i(c,a){if(!n[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+c+"'")}}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){return i(t[c][1][e]||e)},u,u.exports,e,t,n,o)}return n[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({box:[function(e,t,n){"use strict";cc._RF.push(t,"62af4mqATpNWr1Lejl7mPM1","box"),cc.Class({extends:cc.Component,properties:{},showGift:function(){this.node.parent.parent.getComponent("game").confirmGift()},start:function(){}}),cc._RF.pop()},{}],cell:[function(e,t,n){"use strict";cc._RF.push(t,"643df36w9hOSrZesjpa5j1f","cell"),cc.Class({extends:cc.Component,properties:{},died:function(){this.node.endPos?this.node.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.moveTo(.2,this.node.endPos)),cc.removeSelf(!0))):this.node.isFade?this.node.runAction(cc.sequence(cc.fadeOut(1),cc.removeSelf(!0))):this.node.isBroken?this.getComponent(cc.Animation).play():this.node.destroy()},start:function(){}}),cc._RF.pop()},{}],chess:[function(e,t,n){"use strict";cc._RF.push(t,"8627a4gqY1FUrlEQ9fhXzBs","chess");var o=e("over"),i=e("config"),s=e("game_scene");cc.Class({extends:cc.Component,properties:{gameScene:s,over:o,combo:{default:null,type:cc.Prefab}},alignPosition:function(e){var t=cc.v2().sub(e).mag(),n=cc.v2();for(var o in this.cells){var i=o.split(","),s=cc.v2(+i[0],+i[1]),c=s.sub(e).mag();c<t&&(t=c,n=s)}return t<100?n:null},useTool:function(e,t,n){var o=this,i=t?this.alignPosition(t):this.toChsPos;if(!i)return!1;var s=i.x+","+i.y;if(1==e)this.cells[s].isBroken=!0,this.clearCell(s);else if(3==e)this.clearCell(s),this.getLinearPoints(s).forEach(function(e){o.cells[e]&&(o.cells[e].isBroken=!0),o.clearCell(e)});else if(2==e)if(n){var c=cc.instantiate(this.game.chess[n-1]);c.parent=this.board,c.setPosition(i),c.opacity=0,c.runAction(cc.fadeIn(1)),this.cells[s].isFade=!0,this.clearCell(s),this.cells[s]=c,this.game.hidePromotion()}else{if(!this.cells[s])return;this.game.showPromotion(this.cells[s].name),this.toChsPos=i}return!0},clearCell:function(e){this.cells[e]&&(this.cells[e].getComponent("cell").died(),this.cells[e]=0)},clearAll:function(){for(var e in this.cells)this.clearCell(e)},getLinearPoints:function(e){for(var t=e.split(","),n=cc.v2(+t[0],+t[1]),o=cc.v2(n.x+this.cellspacing,n.y),i=[],s=0;s<6;s++){var c=o.add(n.neg()).rotate(Math.PI/3*s).add(n);i.push(Math.round(c.x)+","+Math.round(c.y))}return i},generateChess:function(e,t){var n=this;e||(e=parseInt(2*Math.random())+1,t=60*parseInt(6*Math.random())),this.node.removeAllChildren(!0);var o=[],i=!0;for(var s in this.cells)if(!this.cells[s]&&(this.getLinearPoints(s).forEach(function(e){0==n.cells[e]&&(i=!1)}),!i))break;i&&(e=1);var c=this.game.node.getChildByName("xzdk3");c.active=1!=e;if(1==e)o.push(cc.v2()),c.angle=30;else{c.angle=30+t-90;var a=cc.v2(this.cellspacing/2,0);t=t*Math.PI/180,o.push(a.rotate(t)),o.push(a.rotate(t-Math.PI))}var r=[0,1,2,3,4,5];o.forEach(function(e){var t=parseInt(Math.random()*r.length),o=cc.instantiate(n.game.chess[r[t]]);r.splice(t,1),o.setPosition(Math.round(e.x),Math.round(e.y)),o.parent=n.node}),this.node.getComponent(cc.Animation).play()},testPoint:function(e){for(var t,n=this,o=[e];t=o.find(function(e){return!e.checked});){t.checked=!0;var i=Object.keys(t)[0];this.cells[i]&&this.getLinearPoints(i).forEach(function(e){if(!o.find(function(t){return t[e]})&&n.cells[e]&&n.cells[e].name==t[i].name){var s={};s[e]={name:t[i].name},o.push(s)}})}if(o.length>=3){if(cc.audioEngine.playEffect(this.gameScene.effects[7]),e.checked=!1,e.combo=e.combo?e.combo+1:1,e.combo>1){cc.audioEngine.playEffect(this.gameScene.effects[3]);var s=cc.instantiate(this.combo);s.parent=this.game.node.getChildByName("combos"),s.getChildByName("combo").getComponent("combo").comboNum=e.combo;var c=s.parent.getChildren();c.length>1&&c[c.length-2].runAction(cc.moveBy(.2,cc.v2(0,50)))}var a=Object.keys(e)[0],r=this.game.node.convertToNodeSpaceAR(this.board.convertToWorldSpaceAR(this.cells[a].position));return this.game.addFortune(parseInt(5*Math.pow(2,o.length-3)*([1,1.5,2,2.5,3,3.5,4][e.combo-1]||2)),r),e[a].name=+o[0][a].name+1,o.forEach(function(e,t){var o=Object.keys(e)[0];if(n.cells[o]){var i=n.cells[o].name,s=n.cells[o].position;if(n.cells[o].endPos=n.cells[a].position,n.clearCell(o),0==t)if(7==i)n.game.node.getChildByName("tq").getComponent("gift").luckyCount+=1,n.scheduleOnce(function(){n.game.addFortune(30,r),cc.audioEngine.playEffect(n.gameScene.effects[6]),n.getLinearPoints(o).forEach(function(e){n.cells[e]&&(n.cells[e].isBroken=!0),n.clearCell(e)}),n.game.lightAni(o)},.1);else{var c=cc.instantiate(n.game.chess[i]);c.setPosition(s),c.parent=n.board,n.cells[o]=c}}}),!0}return!1},testLink:function(e){for(var t=this;e.length>0;){var n=e.shift();if(this.testPoint(n)){e.unshift(n),this.scheduleOnce(function(){t.testLink(e)},.2);break}}},rotateChess:function(){var e=this.game.node.getChildByName("xzdk3");if(0==e.getNumberOfRunningActions()){e.runAction(cc.rotateTo(.2,e.rotation+60)),cc.audioEngine.playEffect(this.gameScene.effects[8]);var t=this.node.getChildren();t.length>1&&t.forEach(function(e){var t=e.position.mul(2),n=cc.v2(e.position).rotate(-60*Math.PI/180),o=n.mul(2);e.runAction(cc.bezierTo(.2,[t,o,n]))})}},generateCells:function(e){var t=this;if(0!=e){for(var n in this.cells)0==this.cells[n]&&(this.cells[n]=1,this.getLinearPoints(n).forEach(function(e){if(void 0==t.cells[e]){t.cells[e]=0;var n=cc.instantiate(t.game.cell),o=e.split(",");n.setPosition(+o[0],+o[1]),n.parent=t.board}}));this.generateCells(e-1)}else for(var n in this.cells)this.cells[n]=0},gameOver:function(){window.wx&&wx.postMessage({type:"set_key",key:"score",value:i.fortune,maximize:!0}),this.scheduleOnce(this.over.show.bind(this.over),.4)},start:function(){var e=this;this.cells={"0,0":0},this.cellspacing=186,this.game=this.node.parent.getComponent("game"),this.board=this.game.node.getChildByName("board"),this.generateCells(2),this.node.on(cc.Node.EventType.TOUCH_START,function(t){e.srcPos=e.node.getPosition(),e.node.getChildren().forEach(function(t){t.shadow=cc.instantiate(e.game.shadow),t.shadow.parent=e.board,t.shadow.active=!1})}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){var n=t.touch.getDelta(),o=t.touch._point.sub(t.touch._startPoint).mag();e.node.setPosition(e.node.x+n.x,e.node.y+n.y),e.node.getChildren().forEach(function(t){o>10&&(t.offsetY||(t.offsetY=200,t.setPosition(t.x,t.y+t.offsetY)));var n=e.board.convertToNodeSpaceAR(e.node.convertToWorldSpaceAR(t.getPosition())),i=e.alignPosition(n);i&&0==e.cells[i.x+","+i.y]?(t.shadow.active=!0,t.shadow.setPosition(i)):t.shadow.active=!1})},this);var t=function(t){var n=e.node.getChildren(),o=n[0].offsetY||0,i=!n.find(function(e){return!e.shadow.active});if(n.forEach(function(e){e.offsetY&&e.setPosition(e.x,e.y-e.offsetY),e.offsetY=0,e.shadow.destroy()}),i){cc.audioEngine.playEffect(e.gameScene.effects[5]);var s=[];for(e.game.addFortune(n.length,e.game.node.convertToNodeSpaceAR(e.node.convertToWorldSpaceAR(cc.v2(0,o))));n[0];){var c=n[0].shadow.position,a=c.x+","+c.y;e.cells[a]=n[0];var r={};r[a]={name:n[0].name},s.push(r),n[0].setPosition(c),n[0].parent=e.board}s.sort(function(e,t){return e[Object.keys(e)[0]].name-t[Object.keys(t)[0]].name}),e.testLink(s);var h=!1;for(var u in e.cells)if(!e.cells[u]){h=!0;break}h?e.generateChess(parseInt(2*Math.random())+1,60*parseInt(6*Math.random())):e.gameOver()}t.touch._point.sub(t.touch._startPoint).mag()<10&&n.length>1&&e.rotateChess(),e.node.setPosition(e.srcPos)};this.node.on(cc.Node.EventType.TOUCH_END,t),this.node.on(cc.Node.EventType.TOUCH_CANCEL,t)}}),cc._RF.pop()},{config:"config",game_scene:"game_scene",over:"over"}],combo:[function(e,t,n){"use strict";cc._RF.push(t,"e6fd8JGN9pJWLP3yFWNkfJ1","combo"),cc.Class({extends:cc.Component,properties:{comboArr:{default:[],type:cc.SpriteFrame},comboNum:{get:function(){return this._comboNum||(this._comboNum=0)},set:function(e){this._comboNum=e,this.getComponent(cc.Sprite).spriteFrame=this.comboArr[e-2]}}},died:function(){this.node.destroy()},start:function(){}}),cc._RF.pop()},{}],config:[function(e,t,n){"use strict";cc._RF.push(t,"710c34xM6VPQIbUb1YVnl3R","config");var o={game:{},get signTime(){return this._signTime||(this._signTime=JSON.parse(localStorage.getItem("signTime")||"[]")),this._signTime},set signTime(e){this._signTime=e,localStorage.setItem("signTime",JSON.stringify(e))},get toolNum(){return this._toolNum||(this._toolNum=JSON.parse(localStorage.getItem("toolNum")||"[0,0,0,0]")),this._toolNum},set toolNum(e){this._toolNum=e,localStorage.setItem("toolNum",JSON.stringify(e))},get consumeTip(){return this._consumeTip||(this._consumeTip=JSON.parse(localStorage.getItem("consumeTip")||"true")),this._consumeTip},set consumeTip(e){this._consumeTip=e,localStorage.setItem("consumeTip",JSON.stringify(e))},fortune:0,version:"1.0.0"};t.exports=o,cc._RF.pop()},{}],consumetip:[function(e,t,n){"use strict";cc._RF.push(t,"7a122HXfeBBurLYCBB3pczN","consumetip");var o=e("config");cc.Class({extends:cc.Component,properties:{},hide:function(e,t){this.node.active=!1,this.closeCb&&(this.closeCb(t),this.closeCb=null)},noTip:function(e){o.consumeTip=!e.isChecked},show:function(e,t,n){this.node.active=!0,this.node.getChildByName("consumenum").getComponent(cc.Label).string="/"+n,this.closeCb=t},start:function(){}}),cc._RF.pop()},{config:"config"}],game_scene:[function(e,t,n){"use strict";cc._RF.push(t,"4819cCR7cpBXIj5frn7nCuC","game_scene"),cc.Class({extends:cc.Component,properties:{effects:{default:[],type:cc.AudioClip}},onLoad:function(){if(window.wx){var e=cc.view.getVisibleSize();window.sharedCanvas.width=e.width,window.sharedCanvas.height=e.height}},playBtSound:function(){cc.audioEngine.playEffect(this.effects[2])},start:function(){}}),cc._RF.pop()},{}],game:[function(e,t,n){"use strict";cc._RF.push(t,"854422RgVtExLbxWDRd2Eyi","game");var o=e("config"),i=e("tooltip"),s=e("consumetip"),c=e("chess"),a=e("game_scene");cc.Class({extends:cc.Component,properties:{chess:{default:[],type:cc.Prefab},gameScene:a,shadow:{default:null,type:cc.Prefab},manager:c,cell:{default:null,type:cc.Prefab},scoreEffect:{default:null,type:cc.Prefab},light:{default:null,type:cc.Prefab},fortuneLabel:cc.Label,tooltip:i,consumetip:s},showPromotion:function(e){this.promotion.active=!0,this.promotion.getChildByName("wrap").getChildren().forEach(function(t){return t.active=t.name!=e})},hidePromotion:function(){this.promotion.active=!1,this.varyType=0},lightAni:function(e){var t=e.split(","),n=cc.instantiate(this.light);n.setPosition(+t[0],+t[1]),n.parent=this.board,n.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,.3),cc.moveTo(.5,cc.v2(-425,473))),cc.removeSelf(!0)))},addFortune:function(e,t){o.fortune+=e;for(var n=this.useNum.findIndex(function(e){return e>o.fortune}),i=0;i<4;i++)this.node.getChildByName("tool"+i).getComponent(cc.Toggle).interactable=!!(i<n||o.toolNum[i]);var s=cc.instantiate(this.scoreEffect);s.getChildByName("score").getComponent(cc.Label).string="."+e,s.parent=this.node,s.setPosition(t)},startBox:function(){this.node.getChildByName("tq").getChildByName("tqani").getComponent(cc.Animation).play(),cc.audioEngine.playEffect(this.gameScene.effects[0])},confirmGift:function(e){this.giftType=this.node.getChildByName("tq").getComponent("gift").generateGift(),this.tooltip.show(e,this.getGift.bind(this),this.giftType),cc.audioEngine.playEffect(this.gameScene.effects[1])},getGift:function(e){o.toolNum[this.giftType]+=+e,o.toolNum=o.toolNum.slice(),this.updateToolState()},updateToolState:function(){for(var e=0;e<4;e++){var t=this.node.getChildByName("tool"+e);t.getComponent(cc.Toggle).interactable=o.toolNum[e]>0||o.fortune>=this.useNum[e];var n=t.getChildByName("num");o.toolNum[e]>0?(n.getComponent(cc.Label).string=o.toolNum[e],n.color=cc.color(235,100,180)):(n.getComponent(cc.Label).string="/"+this.useNum[e],n.color=cc.color(255,255,255))}},consumeTool:function(e){e<=1?cc.audioEngine.playEffect(this.gameScene.effects[4]):3==e&&cc.audioEngine.playEffect(this.gameScene.effects[6]),o.toolNum[e]>0?(o.toolNum[e]-=1,o.toolNum=o.toolNum.slice()):o.fortune-=this.useNum[e],this.updateToolState()},execPromotion:function(e,t){this.manager.useTool(this.varyType,null,t),this.consumeTool(2)},resetChess:function(){var e=this,t=function(){e.consumeTool(0),e.manager.generateChess()};o.toolNum[0]<=0&&o.consumeTip?this.consumetip.show(null,function(e){return 0!=e&&t()},this.useNum[0]):t()},hide:function(){this.node.active=!1},show:function(){var e=this;this.node.active=!0,cc.audioEngine.pauseMusic(),this.varyType=0,this.scheduleOnce(function(){e.manager.clearAll(),e.manager.generateChess()},.01),o.fortune=0,this.fortuneLabel.string=0,this.useNum=[300,500,800,1e3,Number.MAX_VALUE],this.updateToolState()},start:function(){var e=this;this.board=this.node.getChildByName("board"),this.promotion=this.node.getChildByName("promotion"),this.board.on(cc.Node.EventType.TOUCH_START,function(t){e.varyType>0&&(e.manager.useTool(e.varyType,e.board.convertToNodeSpaceAR(t.touch._point)),e.node.getChildByName("tool"+e.varyType).getComponent(cc.Toggle).isChecked=!1,2!=e.varyType&&(e.consumeTool(e.varyType),e.varyType=0))})},toggleState:function(e,t){var n=this,i=e.isChecked?t:0;o.toolNum[t]<=0&&o.consumeTip?this.consumetip.show(null,function(t){0!=t?n.varyType=i:e.isChecked=!1},this.useNum[i]):this.varyType=i},update:function(e){if(this.fortuneLabel.string!=o.fortune){var t=(o.fortune-this.fortuneLabel.string)*e,n=t<0?-1:1;this.fortuneLabel.string=+this.fortuneLabel.string+n*Math.ceil(Math.abs(t))}}}),cc._RF.pop()},{chess:"chess",config:"config",consumetip:"consumetip",game_scene:"game_scene",tooltip:"tooltip"}],gift:[function(e,t,n){"use strict";cc._RF.push(t,"f1cabS2gvxJsYk4LJjwmVWU","gift"),cc.Class({extends:cc.Component,properties:{_canUseNum:0,canUseNum:{get:function(){return this._canUseNum},set:function(e){this.node.getComponent(cc.Button).interactable=e>0,this.node.getChildByName("canNum").getComponent(cc.Label).string=e>0?e:"",this.node.getChildByName("tqdbgy").active=e>0,this._canUseNum=e}},_luckyCount:0,luckyCount:{get:function(){return this._luckyCount},set:function(e){e==this.needCount?(this._luckyCount=0,this.needCount+=1,this.canUseNum+=1):this._luckyCount=e,this.node.getChildByName("progress").getComponent(cc.Label).string=this._luckyCount+"/"+this.needCount}}},generateGift:function(){this.canUseNum-=1,this.usedCount+=1,this.giftRate=[Math.min(.35,.2+.04*this.usedCount),Math.min(.3,.1+.04*this.usedCount),Math.min(.3,.1+.04*this.usedCount)],this.giftRate.unshift(1-this.giftRate.reduce(function(e,t){return e+t},0));for(var e=0,t=0;t<this.giftRate.length;t++)e+=this.giftRate[t],this.giftRate[t]=e;return this.giftRate.findIndex(function(e){return e>Math.random()})},start:function(){this.usedCount=0,this.needCount=2,this.luckyCount=0}}),cc._RF.pop()},{}],home:[function(e,t,n){"use strict";cc._RF.push(t,"28a5e8pgZ5KkJoYTySXELkl","home");var o=e("config"),i=e("game_scene");cc.Class({extends:cc.Component,properties:{game_scene:i},getShareInfo:function(e){return e=e||"",{title:o.game.shareTitle[0],imageUrl:o.game.shareImg[0],query:e}},toggleSound:function(e){var t=e.isChecked?0:1;cc.audioEngine.setEffectsVolume(t),cc.audioEngine.setMusicVolume(t)},hide:function(){this.node.active=!1,this.unschedule(this.updateSubGame)},updateSubGame:function(){this.node.getChildByName("sub_canvas").getComponent(cc.WXSubContextView).update()},show:function(){this.node.active=!0,cc.audioEngine.isMusicPlaying()||cc.audioEngine.playMusic(this.game_scene.effects[9],!0),window.wx&&(window.sharedCanvas.width=850,window.sharedCanvas.height=500,this.schedule(this.updateSubGame,.2,20),wx.postMessage({type:"show_userinfo",size:{width:850,height:500}}))},share:function(e,t){window.wx&&window.wx.shareAppMessage(this.getShareInfo(t))},handleOptions:function(e){},loadAni:function(){var e=this;o.game.recommend&&o.game.recommend.forEach(function(t){var n={appId:t.appId,frames:[],host:e},i=t.images.match(/(.+\/)([^/]+)\..+(\d+)-(\d+)/),s=i[1],c=i[2],a=i[3],r=i[4];n.frameLength=r-a+1;for(var h=a;h<=r;h++)cc.loader.load(""+s+c+h+".png",function(e,t){if(this.frames.push(new cc.SpriteFrame(t)),this.frames.length==this.frameLength){var n=new cc.AnimationClip;n.name=this.appId;for(var i=[],s=o.game.frameInterval||.2,c=0;c<this.frameLength;c++)i.push({frame:c*s,value:this.frames[c]});n.curveData={comps:{"cc.Sprite":{spriteFrame:i}}},n.wrapMode=2,n._duration=this.frameLength*s,this.host.aniCom.addClip(n),1==this.host.aniCom._clips.length&&this.host.nextGame()}}.bind(n))})},nextGame:function(){var e=this;0!=this.aniCom._clips.length&&this.node.active&&(this.curPlayIndex=(this.curPlayIndex+1)%this.aniCom._clips.length,this.recommendName=this.aniCom._clips[this.curPlayIndex].name,this.aniCom.play(this.recommendName),this.timer=setTimeout(this.nextGame.bind(this),1e3*o.game.recommend.find(function(t){return t.appId==e.recommendName}).time))},start:function(){var e=this;this.curPlayIndex=0,this.aniCom=this.node.getChildByName("recommend").getComponent(cc.Animation),cc.loader.loadRes("config",function(t,n){console.log("load config err:",t),t&&0!=t.status&&200!=t.status||(o.game=JSON.parse(n));var i=new XMLHttpRequest;i.onreadystatechange=function(){4!=i.readyState||200!=i.status&&0!=i.status||(console.log("config change to server!"),o.game=JSON.parse(i.responseText),o.version<o.game.version?(o.game.lure=o.game.oldVersion_lure,console.log("user old version lure!")):console.log("user new version lure!"),o.game.lure&&e.loadAni())},i.open("GET","https://config.023mama.com/static/config/lucky666/config.txt",!0),i.send()}),window.wx&&wx.onShow(this.handleOptions),this.scheduleOnce(this.show,1.5)}}),cc._RF.pop()},{config:"config",game_scene:"game_scene"}],over:[function(e,t,n){"use strict";cc._RF.push(t,"62566DnChZIbaz5eSSku7Iv","over");var o=e("config"),i=e("home");cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,home:i},updateSubGame:function(){this.node.getChildByName("sub_canvas").getComponent(cc.WXSubContextView).update()},hide:function(){this.node.active=!1,this.unschedule(this.updateSubGame)},show:function(){this.node.active=!0,this.scoreLabel.string=o.fortune,window.wx&&(window.sharedCanvas.width=1e3,window.sharedCanvas.height=1200,wx.postMessage({type:"show_over",size:{width:1e3,height:1200}}),this.schedule(this.updateSubGame,1,4,.05))},start:function(){}}),cc._RF.pop()},{config:"config",home:"home"}],rank:[function(e,t,n){"use strict";cc._RF.push(t,"a8a88Jo8hxFjo6uxoLp7WYV","rank");var o=e("home");cc.Class({extends:cc.Component,properties:{home:o},hide:function(){this.node.active=!1,this.unschedule(this.updateSubGame)},prePage:function(){window.wx&&(wx.postMessage({type:"pre_page"}),this.schedule(this.updateSubGame,.1,4))},nextPage:function(){window.wx&&(wx.postMessage({type:"next_page"}),this.schedule(this.updateSubGame,.1,4))},updateSubGame:function(){this.node.getChildByName("sub_canvas").getComponent(cc.WXSubContextView).update()},show:function(){this.node.active=!0,window.wx&&(window.sharedCanvas.width=1080,window.sharedCanvas.height=1570,wx.postMessage({type:"show_rank",size:{width:1080,height:1570}}),this.schedule(this.updateSubGame,.1,10))},start:function(){}}),cc._RF.pop()},{home:"home"}],removeSelf:[function(e,t,n){"use strict";cc._RF.push(t,"e5068zeUl1Pmr+lwDWQWYcg","removeSelf"),cc.Class({extends:cc.Component,properties:{},died:function(){this.node.parent.destroy()},start:function(){}}),cc._RF.pop()},{}],sign:[function(e,t,n){"use strict";cc._RF.push(t,"a6cfaDhoAdCspY1yM+RMVDQ","sign");var o=e("config");cc.Class({extends:cc.Component,properties:{sbg:{default:[],type:cc.SpriteFrame}},normalTime:function(e){var t=new Date(e);return e-(60*t.getHours()*60*1e3+60*t.getMinutes()*1e3+1e3*t.getSeconds()+t.getMilliseconds())},getState:function(e){for(var t=[-1,-1,-1,-1,-1,-1,-1],n=this.normalTime(Date.now()),o=!1,i=Math.min(6,e.length-1),s=0;i>=0;i--){var c=this.normalTime(e[i]);if(!(n-c<=864e5))break;n==c&&(o=!0),t[s++]=1,n=c}return o||(t[s]=0,7==s&&(t=[0,-1,-1,-1,-1,-1,-1])),t},hide:function(){this.node.active=!1},show:function(){this.node.active=!0},updateState:function(e){var t=e.findIndex(function(e){return 0==e}),n=this.node.getChildByName("getgift").getComponent(cc.Toggle);n.interactable=-1!=t,n.isChecked=-1==t;for(var o=0;o<7;o++){var i=this.node.getChildByName("day"+(o+1)),s=i.getComponent(cc.Sprite),c=i.getChildByName("signed"),a=i.getComponent(cc.Button);if(-1==e[o]){var r=o<6?0:2;s.spriteFrame=this.sbg[r],c.active=!1,a.interactable=!1}else if(0==e[o]){r=o<6?4:5;s.spriteFrame=this.sbg[r],c.active=!1,a.interactable=!0}else if(1==e[o]){r=o<6?1:3;s.spriteFrame=this.sbg[r],c.active=!0,a.interactable=!1}}},sign:function(e){var t=[{0:2},{1:2},{0:1,2:1},{1:1,2:1},{0:2,3:1},{1:2,3:1},{0:1,1:1,2:1,3:1}][this.sta.findIndex(function(e){return 0==e})];for(var n in t)o.toolNum[n]+=t[n];o.toolNum=o.toolNum.slice(),o.signTime.push(Date.now()),o.signTime=o.signTime.slice(),this.updateState(this.getState(o.signTime))},onLoad:function(){this.sta=this.getState(o.signTime);var e=this.sta.findIndex(function(e){return 0==e});this.node.active=-1!=e,this.updateState(this.sta)}}),cc._RF.pop()},{config:"config"}],tooltip:[function(e,t,n){"use strict";cc._RF.push(t,"35478F+cM1K2JnhV4cDkX9N","tooltip"),cc.Class({extends:cc.Component,properties:{toolIcon:{default:[],type:cc.SpriteFrame}},hide:function(e,t){this.node.active=!1,this.closeCb&&(this.closeCb(t),this.closeCb=null)},show:function(e,t,n){this.node.active=!0,this.node.opacity=0,this.node.runAction(cc.fadeIn(.6)),this.node.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=this.toolIcon[n],this.closeCb=t},start:function(){}}),cc._RF.pop()},{}]},{},["box","cell","chess","combo","config","consumetip","game","game_scene","gift","home","over","rank","removeSelf","sign","tooltip"]);